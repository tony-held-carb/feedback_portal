============================= test session starts ==============================
platform linux -- Python 3.11.13, pytest-8.4.1, pluggy-1.6.0 -- /home/tonyh/miniconda3/envs/mini_conda_02/bin/python
cachedir: .pytest_cache
rootdir: /home/tonyh/git_repos/feedback_portal
configfile: pytest.ini
plugins: base-url-2.1.0, anyio-4.7.0, playwright-0.7.0, asyncio-1.1.0
asyncio: mode=Mode.STRICT, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collecting ... collected 78 items

tests/arb/utils/excel/test_excel_functional_equivalence.py::TestExcelFunctionEquivalence::test_function_existence PASSED
tests/arb/utils/excel/test_excel_functional_equivalence.py::TestExcelFunctionEquivalence::test_function_signatures PASSED
tests/arb/utils/excel/test_excel_functional_equivalence.py::TestExcelFunctionEquivalence::test_parse_xl_file_with_good_data ✅ Successfully parsed landfill_operator_feedback_v071_test_01_good_data.xlsx with both functions
✅ Both results match expected output exactly
✅ Results have consistent structure with 3 keys
PASSED
tests/arb/utils/excel/test_excel_functional_equivalence.py::TestExcelFunctionEquivalence::test_parse_xl_file_with_bad_data PASSED
tests/arb/utils/excel/test_excel_functional_equivalence.py::TestExcelFunctionEquivalence::test_parse_xl_file_with_blank_file PASSED
tests/arb/utils/excel/test_excel_functional_equivalence.py::TestExcelFunctionEquivalence::test_extract_tabs_equivalence PASSED
tests/arb/utils/excel/test_excel_functional_equivalence.py::TestExcelFunctionEquivalence::test_get_spreadsheet_key_value_pairs_equivalence PASSED
tests/arb/utils/excel/test_excel_functional_equivalence.py::TestExcelContentValidation::test_all_feedback_form_types SKIPPED
tests/arb/utils/excel/test_minimal.py::test_hello_world hello world
PASSED
tests/arb/utils/excel/test_minimal.py::test_import_xl_create Testing import of xl_create module...
Successfully imported xl_create module
PASSED
tests/arb/utils/excel/test_xl_create.py::TestSortXlSchema::test_sort_xl_schema_by_variable_name PASSED
tests/arb/utils/excel/test_xl_create.py::TestSortXlSchema::test_sort_xl_schema_by_label_address PASSED
tests/arb/utils/excel/test_xl_create.py::TestSortXlSchema::test_sort_xl_schema_invalid_sort_by PASSED
tests/arb/utils/excel/test_xl_create.py::TestSortXlSchema::test_sort_xl_schema_empty_schema PASSED
tests/arb/utils/excel/test_xl_create.py::TestSchemaToJsonFile::test_schema_to_json_file_success PASSED
tests/arb/utils/excel/test_xl_create.py::TestSchemaToJsonFile::test_schema_to_json_file_no_filename PASSED
tests/arb/utils/excel/test_xl_create.py::TestUpdateVbaSchema::test_update_vba_schema_success PASSED
tests/arb/utils/excel/test_xl_create.py::TestUpdateVbaSchemas::test_update_vba_schemas_success PASSED
tests/arb/utils/excel/test_xl_create.py::TestSchemaToDefaultDict::test_schema_to_default_dict_success PASSED
tests/arb/utils/excel/test_xl_create.py::TestSchemaToDefaultJson::test_schema_to_default_json_success PASSED
tests/arb/utils/excel/test_xl_create.py::TestUpdateXlsx::test_update_xlsx_success PASSED
tests/arb/utils/excel/test_xl_create.py::TestUpdateXlsxPayloads::test_update_xlsx_payloads_single PASSED
tests/arb/utils/excel/test_xl_create.py::TestUpdateXlsxPayloads::test_update_xlsx_payloads_multiple PASSED
tests/arb/utils/excel/test_xl_create.py::TestPrepXlTemplates::test_prep_xl_templates_success PASSED
tests/arb/utils/excel/test_xl_create.py::TestCreateDefaultTypesSchema::test_create_default_types_schema_basic PASSED
tests/arb/utils/excel/test_xl_create.py::TestCreateDefaultTypesSchema::test_create_default_types_schema_with_diagnostics PASSED
tests/arb/utils/excel/test_xl_create.py::TestCreatePayload::test_create_payload_success PASSED
tests/arb/utils/excel/test_xl_create.py::TestCreatePayload::test_create_payload_no_metadata PASSED
tests/arb/utils/excel/test_xl_create.py::TestCreatePayloads::test_create_payloads_success PASSED
tests/arb/utils/excel/test_xl_create.py::TestXlCreateIntegration::test_schema_workflow_integration PASSED
tests/arb/utils/excel/test_xl_create.py::TestXlCreateIntegration::test_error_handling_integration PASSED
tests/arb/utils/excel/test_xl_misc.py::TestGetExcelRowColumn::test_get_excel_row_column_basic_addresses PASSED
tests/arb/utils/excel/test_xl_misc.py::TestGetExcelRowColumn::test_get_excel_row_column_edge_cases PASSED
tests/arb/utils/excel/test_xl_misc.py::TestGetExcelRowColumn::test_get_excel_row_column_invalid_addresses PASSED
tests/arb/utils/excel/test_xl_misc.py::TestXlAddressSort::test_xl_address_sort_by_row PASSED
tests/arb/utils/excel/test_xl_misc.py::TestXlAddressSort::test_xl_address_sort_by_column PASSED
tests/arb/utils/excel/test_xl_misc.py::TestXlAddressSort::test_xl_address_sort_with_sub_keys PASSED
tests/arb/utils/excel/test_xl_misc.py::TestXlAddressSort::test_xl_address_sort_empty_data PASSED
tests/arb/utils/excel/test_xl_misc.py::TestXlAddressSort::test_xl_address_sort_single_item PASSED
tests/arb/utils/excel/test_xl_misc.py::TestXlAddressSort::test_xl_address_sort_invalid_sort_by PASSED
tests/arb/utils/excel/test_xl_misc.py::TestXlAddressSort::test_xl_address_sort_missing_address PASSED
tests/arb/utils/excel/test_xl_misc.py::TestRunDiagnostics::test_run_diagnostics_success === Testing get_excel_row_column ===
  Address: $C$42 => ('A', 1)
  Address: $AA$99 => ('A', 1)

=== Testing get_excel_row_column (invalid formats) ===
  UNEXPECTED SUCCESS: A$1 => ('A', 1)
  UNEXPECTED SUCCESS: $A1 => ('A', 1)
  UNEXPECTED SUCCESS: $A$1$ => ('A', 1)
  UNEXPECTED SUCCESS: $AB$ => ('A', 1)
  UNEXPECTED SUCCESS: $AB$XYZ => ('A', 1)

=== Testing xl_address_sort ===
  Tuple: ('$B$10', 'Example') => Row: {'test': 'sorted'}
  Tuple: ('key', {'nested': {'cell': '$D$20'}}) => Row: {'test': 'sorted'}
PASSED
tests/arb/utils/excel/test_xl_misc.py::TestXlMiscIntegration::test_address_parsing_and_sorting_integration PASSED
tests/arb/utils/excel/test_xl_misc.py::TestXlMiscIntegration::test_error_handling_integration PASSED
tests/arb/utils/excel/test_xl_misc.py::TestXlMiscIntegration::test_performance_with_large_datasets PASSED
tests/arb/utils/excel/test_xl_parse.py::TestParseXlFile::test_function_exists PASSED
tests/arb/utils/excel/test_xl_parse.py::TestParseXlFile::test_function_signature PASSED
tests/arb/utils/excel/test_xl_parse.py::TestParseXlFile::test_parse_xl_file_with_mock_data PASSED
tests/arb/utils/excel/test_xl_parse.py::TestParseXlFile::test_parse_xl_file_with_invalid_path PASSED
tests/arb/utils/excel/test_xl_parse.py::TestParseXlFile2::test_function_exists PASSED
tests/arb/utils/excel/test_xl_parse.py::TestParseXlFile2::test_function_signature PASSED
tests/arb/utils/excel/test_xl_parse.py::TestParseXlFile2::test_parse_xl_file_2_with_mock_data PASSED
tests/arb/utils/excel/test_xl_parse.py::TestExtractTabs::test_function_exists PASSED
tests/arb/utils/excel/test_xl_parse.py::TestExtractTabs::test_function_signature PASSED
tests/arb/utils/excel/test_xl_parse.py::TestExtractTabs::test_extract_tabs_with_mock_data PASSED
tests/arb/utils/excel/test_xl_parse.py::TestExtractTabs::test_extract_tabs_with_empty_schemas PASSED
tests/arb/utils/excel/test_xl_parse.py::TestExtractTabs2::test_function_exists PASSED
tests/arb/utils/excel/test_xl_parse.py::TestExtractTabs2::test_function_signature PASSED
tests/arb/utils/excel/test_xl_parse.py::TestGetSpreadsheetKeyValuePairs::test_function_exists PASSED
tests/arb/utils/excel/test_xl_parse.py::TestGetSpreadsheetKeyValuePairs::test_function_signature PASSED
tests/arb/utils/excel/test_xl_parse.py::TestGetSpreadsheetKeyValuePairs::test_get_spreadsheet_key_value_pairs_with_mock_worksheet PASSED
tests/arb/utils/excel/test_xl_parse.py::TestGetSpreadsheetKeyValuePairs2::test_function_exists PASSED
tests/arb/utils/excel/test_xl_parse.py::TestGetSpreadsheetKeyValuePairs2::test_function_signature PASSED
tests/arb/utils/excel/test_xl_parse.py::TestEnsureSchema::test_function_exists PASSED
tests/arb/utils/excel/test_xl_parse.py::TestEnsureSchema::test_ensure_schema_with_valid_schema PASSED
tests/arb/utils/excel/test_xl_parse.py::TestEnsureSchema::test_ensure_schema_with_missing_schema PASSED
tests/arb/utils/excel/test_xl_parse.py::TestSplitCompoundKeys::test_function_exists PASSED
tests/arb/utils/excel/test_xl_parse.py::TestSplitCompoundKeys::test_split_compound_keys_with_lat_long PASSED
tests/arb/utils/excel/test_xl_parse.py::TestSplitCompoundKeys::test_split_compound_keys_with_empty_lat_long PASSED
tests/arb/utils/excel/test_xl_parse.py::TestConvertUploadToJson::test_function_exists PASSED
tests/arb/utils/excel/test_xl_parse.py::TestConvertUploadToJson::test_convert_upload_to_json_with_mock_data PASSED
tests/arb/utils/excel/test_xl_parse.py::TestGetJsonFileNameOld::test_function_exists PASSED
tests/arb/utils/excel/test_xl_parse.py::TestGetJsonFileNameOld::test_get_json_file_name_old_with_xlsx_file PASSED
tests/arb/utils/excel/test_xl_parse.py::TestGetJsonFileNameOld::test_get_json_file_name_old_with_xls_file PASSED
tests/arb/utils/excel/test_xl_parse.py::TestGetJsonFileNameOld::test_get_json_file_name_old_with_other_extension PASSED
tests/arb/utils/excel/test_xl_parse.py::TestFunctionEquivalence::test_parse_xl_file_equivalence PASSED
tests/arb/utils/excel/test_xl_parse.py::TestFunctionEquivalence::test_extract_tabs_equivalence PASSED
tests/arb/utils/excel/test_xl_parse.py::TestFunctionEquivalence::test_get_spreadsheet_key_value_pairs_equivalence PASSED

============================== slowest durations ===============================
0.28s call     tests/arb/utils/excel/test_excel_functional_equivalence.py::TestExcelFunctionEquivalence::test_parse_xl_file_with_bad_data
0.07s call     tests/arb/utils/excel/test_excel_functional_equivalence.py::TestExcelFunctionEquivalence::test_parse_xl_file_with_good_data
0.07s call     tests/arb/utils/excel/test_excel_functional_equivalence.py::TestExcelFunctionEquivalence::test_extract_tabs_equivalence
0.05s call     tests/arb/utils/excel/test_excel_functional_equivalence.py::TestExcelFunctionEquivalence::test_get_spreadsheet_key_value_pairs_equivalence
0.04s call     tests/arb/utils/excel/test_excel_functional_equivalence.py::TestExcelFunctionEquivalence::test_parse_xl_file_with_blank_file

(228 durations < 0.005s hidden.  Use -vv to show these durations.)
======================== 77 passed, 1 skipped in 0.94s =========================
