{% extends 'base.html' %}

{% block title %}
  Upload File
{% endblock %}

{% block header_css_and_js %}
  <link rel="stylesheet" href="{{ url_for('static', filename='css/portal_styles_01.css') }}">
  <script defer src="{{ url_for('static', filename='js/drag_and_drop.js') }}"></script>
{% endblock %}

{% block content_1 %}
  <div class="container-fluid post-nav-padding mb-4">

    <div class="p-3 rounded text-white mb-3 bg-main-header">
      <h2 class="mb-0">Upload Feedback Spreadsheet</h2>
      <small>Please ensure the Excel file is closed before uploading.</small>
    </div>

    <!-- Upload Drop Zone -->
    <div class="d-flex justify-content-center align-items-center mt-4">
      <div id="drop_zone" class="upload-drop-zone">
        <div class="drop-zone-text">Drag & Drop File Here</div>
        <img src="{{ url_for('static', filename='images/upload_icon.png') }}"
             class="drop-zone-icon" alt="Upload Icon">
      </div>
    </div>

    <!-- File Input -->
    <div class="text-center mt-3">
      <form method="POST" enctype="multipart/form-data" action="{{ url_for('main.upload_file') }}">
        {{ form.hidden_tag() }}
        {{ form.file.label(class="form-label") }}
        {{ form.file(class="form-control mb-2") }}
        {{ form.submit(class="btn btn-primary") }}
      </form>
    </div>

    <div class="alert alert-warning mt-3" role="alert">
      <strong>Important:</strong> Please close Excel before uploading a file.
    </div>

  </div>
{% endblock %}

{% block content_2 %}
<!-- Spinner Overlay -->
<div id="upload-spinner-overlay" class="spinner-overlay d-none">
  <div class="spinner-container">
    <div class="spinner-border text-primary" role="status"></div>
    <div class="mt-3 text-white fw-bold">Uploading... Please wait.</div>
  </div>
</div>
{% endblock %}

{% block footer_js %}
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const form = document.querySelector("form");
    const overlay = document.getElementById("upload-spinner-overlay");

    if (form && overlay) {
      form.addEventListener("submit", function (event) {
        console.log("ðŸ“¤ Submitting form...");
        overlay.classList.remove("d-none");
      });
    }
  });
</script>
{% endblock %}
